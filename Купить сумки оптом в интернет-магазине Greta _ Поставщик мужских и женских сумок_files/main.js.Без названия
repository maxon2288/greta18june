jQuery(document).ready(function($){$('input[type="tel"]').on('keypress',function(event){var key,keyChar;if(!event)var event=window.event;if(event.keyCode)key=event.keyCode;else if(event.which)key=event.which;if(key==null||key==0||key==8||key==13||key==37||key==39||key==46||key==9)return true;keyChar=String.fromCharCode(key);if(!/[0-9-\+]/.test(keyChar))return false;});$('input[type="radio"]').on('click',function(event){if($(this).hasClass('active'))$(this).removeAttr("checked");$(this).toggleClass('active');});$('.nice-select').niceSelect();$('.toggle_burger').on('click',function(event){$(this).toggleClass('close');});$('.header__toggle').click(function(event){$('.header__menu').toggleClass('menu_open');});$('.aside_toggle').click(function(event){$('.aside--left, .main__overlay').toggleClass('visible');$(this).find('.toggle_burger').toggleClass('close').parent().toggleClass('close');});$('.main__overlay').on('click touchstart',function(event){$(this).removeClass('visible');$('.toggle_burger').removeClass('close').parent().removeClass('close');$('.aside--left').removeClass('visible');});var swiperHome=new Swiper('.home__slider',{pagination:'.home__pagination',paginationClickable:true,nextButton:$('.home__slider').find('.home__slider__btn--next'),prevButton:$('.home__slider').find('.home__slider__btn--prev'),slidesPerView:1,autoplay:4000});$('.goods__items.swiper-container').each(function(index,el){elem=$(this);var swiper=new Swiper(elem,{nextButton:elem.parents('.goods').find('.goods__control__btn--next'),prevButton:elem.parents('.goods').find('.goods__control__btn--prev'),slidesPerView:11,spaceBetween:10,loop:true,breakpoints:{420:{slidesPerView:2,},720:{slidesPerView:3,},998:{slidesPerView:4,},1200:{slidesPerView:5,},1800:{slidesPerView:7,},2000:{slidesPerView:8,},2300:{slidesPerView:9,},2800:{slidesPerView:10,},3100:{slidesPerView:11,},}});});$(document).on('mouseover touchstart','.goods__item',function(event){$(this).find('.goods__collapse').addClass('visible').parent().css('z-index','3');;});$(document).on('mouseout touchstart','.goods__item',function(event){$(this).find('.goods__collapse').removeClass('visible').parent().css('z-index','1');;});$('.video').on('click',function(event){$(this).addClass('hidden')
var $video=$('.video iframe'),src=$video.attr('src');$video.attr('src',src+'&autoplay=1');});window.inputNumber=function(el){var min=el.attr('min')||false;var max=el.attr('max')||false;var els={};els.dec=el.prev();els.inc=el.next();el.each(function(){init($(this));});function init(el){els.dec.on('click',decrement);els.inc.on('click',increment);function decrement(){var value=el[0].value;value--;if(!min||value>=min){el[0].value=value;}el.trigger('change');}function increment(){var value=el[0].value;value++;if(!max||value<=max){el[0].value=value++;}el.trigger('change');}}el.keyup(function(){$(this).val($(this).val().replace(/\D/,''));});}
$('.count input').each(function(index,el){inputNumber($(this));});$('.why__text').readmore({speed:100,maxHeight:270,moreLink:'<span class="redlink">Развернуть текст</span>',lessLink:'<span class="redlink">Свернуть текст</span>',});var sliderElm=$(".sliderElm").slider({range:true,create:function(event,ui){$(this).slider("option","min",parseInt($(this).parents('.rangeSlider').find('.minCost').attr('data-minCount')));$(this).slider("option","max",parseInt($(this).parents('.rangeSlider').find('.maxCost').attr('data-maxCount')));$(this).slider("option","values",[$(this).slider("option","min"),$(this).slider("option","max")]);},stop:function(event,ui){$(this).parents('.rangeSlider').find('.minCost').val($(this).slider("values",0));$(this).parents('.rangeSlider').find('.maxCost').val($(this).slider("values",1));},slide:function(event,ui){$(this).parents('.rangeSlider').find('.minCost').val($(this).slider("values",0));$(this).parents('.rangeSlider').find('.maxCost').val($(this).slider("values",1));}});if(parseInt($('.rangeSlider input.minCost').val())){sliderElm.slider("values",0,parseInt($('.rangeSlider input.minCost').val()));}if(parseInt($('.rangeSlider input.maxCost').val())){sliderElm.slider("values",1,parseInt($('.rangeSlider input.maxCost').val()));}$('.rangeSlider input.minCost').on('keyup',function(event){$(this).val($(this).val().replace(/\D/,''));sliderElm.slider("values",0,parseInt($(this).val()));});$('.rangeSlider input.maxCost').on('keyup',function(event){$(this).val($(this).val().replace(/\D/,''));sliderElm.slider("values",1,parseInt($(this).val()));});$('.cart__table .count input').on('change',function(event){price=$(this).parents('.cart__row').find('.oneprice').text()*$(this).val();$(this).parents('.cart__row').find('.cart__col--price').find('b').text(price);totalPrice();});$('.cart_remove').on('click',function(event){$(this).parents('.cart__row').remove();totalPrice();});totalPrice();function totalPrice(){summ=0;count=0;$('.cart__col--price b').each(function(index,el){summ=summ+parseInt($(this).text());});$('.cart__table .count input').each(function(index,el){count=count+parseInt($(this).val());});$('.total_count').text(count);$('.total_sum').text(summ);}$('.cardproduct__info .count input').on('change',function(event){count=$(this).val();price=$(this).closest('.cardproduct__info').find('.cardproduct__price').find('span').text();total=price.replace(/\D/g,"")*count+'';$('.cardproduct__total b').text(total.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,'$1 '));});var galleryTop=new Swiper('.cardproduct__image',{spaceBetween:10,slidesPerView:1,});var galleryThumbs=new Swiper('.cardproduct__thumbs',{spaceBetween:10,slidesPerView:5,touchRatio:0.2,slideToClickedSlide:true,centeredSlides:true,direction:'vertical',virtualTranslate:true,autoHeight:true,breakpoints:{998:{direction:'horizontal',}}});galleryTop.params.control=galleryThumbs;galleryThumbs.params.control=galleryTop;$('.cardproduct__thumbs .swiper-slide').on('click',changeMainSlide)
function changeMainSlide(){var ind=$(this).index();galleryTop.slideTo(ind)
galleryThumbs.slideTo(ind)
if(ind>=3){$('.cardproduct__thumbs .swiper-wrapper').css({transform:'translateY('+(ind-3)*(-$('.cardproduct__thumb').height()+-galleryThumbs.params.spaceBetween-2)+'px)'})}else if(ind<3){return}}$('.zoom').each(function(index,el){$(this).easyZoom({selector:{preview:'.preview-zoom',window:"#window-zoom"}});});$('.zoom img').on('mouseenter',function(e){winScrollTop=$(window).scrollTop();offset=$(this).offset();zoomScale=1;$('.zoom img').on('mousemove',function(e){var X=((e.pageX-offset.left)/$(this).width()*100).toFixed(2);var Y=((e.pageY-offset.top)/$(this).height()*100).toFixed(2);$('#window-zoom img').css({transformOrigin:X+'% '+Y+'%'})});if($(this)[0].addEventListener){if('onwheel'in document){$(this)[0].addEventListener("wheel",onWheel);}else if('onmousewheel'in document){$(this)[0].addEventListener("mousewheel",onWheel);}else{$(this)[0].addEventListener("MozMousePixelScroll",onWheel);}}else{$(this)[0].attachEvent("onmousewheel",onWheel);}});function onWheel(e){e=e||window.event;var delta=e.deltaY||e.detail||e.wheelDelta;zoomScale=+zoomScale+delta/1000*-1;console.log()
if(zoomScale>100){zoomScale=100;}else if(zoomScale>0.3){$('#window-zoom img').css({transform:'scale('+zoomScale+')',})}else{zoomScale=0.3;}e.preventDefault?e.preventDefault():(e.returnValue=false);}$('.zoom img').on('mouseout',function(e){$(window).unbind('scroll');$('#window-zoom img').css({transformOrigin:'0 0 0',transform:'scale(1)'});});$('.accordeon').accordion({collapsible:true,active:false,animate:200});if($('.map_canvas').length){mapInitialize();}});function mapInitialize(){$('.map_canvas').each(function(index,el){coord=$(this).attr('data-coord').split(',');elem="map_canvas_"+(index+1);var brooklyn={lat:Number(coord[0]),lng:Number(coord[1]),};var center={lat:brooklyn.lat,lng:brooklyn.lng,}
var mapOptions={zoom:16,center:center,mapTypeControl:false,scrollwheel:false,navigationControl:false,scaleControl:false,draggable:true,};if($(window).width()<=1180){mapOptions.draggable=false;}map=new google.maps.Map(document.getElementById(elem),mapOptions);marker=new google.maps.Marker({map:map,position:brooklyn,icon:'../images/ico/map-mark.png'});});}